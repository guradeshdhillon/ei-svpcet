# Gallery System Documentation\n\n## Google Drive Integration\n\n### Configuration\n\nSet the Google Drive folder ID in your environment:\n\n```bash\n# .env.local (for development)\nGDRIVE_FOLDER_ID=your_folder_id_here\n\n# Vercel Environment Variables (for production)\nGDRIVE_FOLDER_ID=your_folder_id_here\n```\n\n### How to Get Folder ID\n\n1. Open your Google Drive folder in browser\n2. Copy the ID from URL: `https://drive.google.com/drive/folders/[FOLDER_ID]`\n3. Ensure folder is publicly accessible (\"Anyone with the link can view\")\n\n## Preview Generation Strategy\n\n### Thumbnail Sources (in priority order):\n\n1. **Images**: `https://lh3.googleusercontent.com/d/{fileId}=w400`\n2. **Videos**: `https://drive.google.com/thumbnail?id={fileId}&sz=w400`\n3. **Fallback**: Generic placeholder with file name\n\n### Performance Optimizations\n\n#### Backend (API)\n- **Caching**: 5-minute TTL for folder listings\n- **Pagination**: 12 items per page to reduce initial load\n- **Fast Response**: Returns only metadata, no file content\n- **Graceful Degradation**: Hardcoded fallback if Drive API fails\n\n#### Frontend (Gallery)\n- **Progressive Loading**: Renders skeleton → thumbnail → full preview\n- **Lazy Loading**: Images beyond first 8 load on demand\n- **Error Handling**: Failed images show placeholder, don't block others\n- **Optimistic Rendering**: Shows grid immediately, populates as data loads\n\n## Gallery Performance Guarantees\n\n### Speed Targets\n- **Initial Render**: < 200ms (skeleton grid)\n- **First Thumbnails**: < 1s (cached) / < 3s (fresh)\n- **Full Page Load**: < 2s for 12 items\n\n### Reliability Features\n- **No Blank Screens**: Always shows content or meaningful loading state\n- **Partial Failure Handling**: Failed items don't break working ones\n- **Offline Resilience**: Cached data serves when API unavailable\n- **Mobile Optimized**: Responsive grid, touch-friendly interactions\n\n## API Endpoints\n\n### GET `/api/gallery`\n\n**Query Parameters:**\n- `page` (number): Page number (default: 1)\n- `limit` (number): Items per page (default: 12, max: 50)\n\n**Response:**\n```json\n{\n  \"items\": [\n    {\n      \"id\": \"file_id\",\n      \"name\": \"Photo Name\",\n      \"type\": \"image\" | \"video\" | \"unknown\",\n      \"thumbnailUrl\": \"https://...\",\n      \"previewReady\": true\n    }\n  ],\n  \"total\": 45,\n  \"page\": 1,\n  \"hasMore\": true\n}\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Blank Gallery**\n   - Check folder ID is correct\n   - Verify folder is publicly accessible\n   - Check browser console for API errors\n\n2. **Slow Loading**\n   - Reduce items per page in API call\n   - Check network connection\n   - Verify Google Drive CDN accessibility\n\n3. **Missing Thumbnails**\n   - Google Drive may not generate thumbnails for all files\n   - Unsupported file types show placeholder\n   - Large files may have delayed thumbnail generation\n\n### Performance Monitoring\n\nMonitor these metrics:\n- API response time (`/api/gallery`)\n- Thumbnail load success rate\n- Time to first meaningful paint\n- User interaction responsiveness\n\n## Development vs Production\n\n- **Development**: Uses hardcoded file list for reliability\n- **Production**: Fetches from actual Google Drive folder\n- **Fallback**: Always available regardless of Drive API status\n